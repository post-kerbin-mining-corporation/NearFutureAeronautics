// Credit to KnightofStJohn StockWaterfallEffects
// Link to license: https://github.com/KnightofStJohn/StockWaterfallEffects/blob/master/Readme.txt
// Distributed under the Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)
// Modified from original files

@PART[nfa-*]:NEEDS[Waterfall]
{
  // Remove all rocket smoke trails
  !fx_smokeTrail_veryLarge = DELETE
  !fx_smokeTrail_medium = DELETE
  !fx_smokeTrail_medium_thin = DELETE
  !fx_smokeTrail_light = DELETE
  !fx_smokeTrail_* = DELETE

  @EFFECTS
  {
    @fx-*,*
    {
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smokeTrail_veryLarge]] {}
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smokeTrail_medium]] {}
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smokeTrail_medium_thin]] {}
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smokeTrail_light]] {}
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smoke*]],* {}

      !MODEL_MULTI_PARTICLE[*],* {}
      !MODEL_MULTI_PARTICLE,* {}
    }
    @running*,*
    {
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smokeTrail_veryLarge]] {}
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smokeTrail_medium]] {}
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smokeTrail_medium_thin]] {}
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smokeTrail_light]] {}
      !PREFAB_PARTICLE:HAS[#prefabName[fx_smoke*]],* {}

      !MODEL_MULTI_PARTICLE[*],* {}
      !MODEL_MULTI_PARTICLE,* {}
    }
    @*,*
    {
      !MODEL_MULTI_PARTICLE[*],* {}
      !MODEL_MULTI_PARTICLE,* {}
    }
  }
}


// AE1 Broadsword
@PART[nfa-multimodal-25-1]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = BroadswordOpen
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = AirBreathing
      responseRateUp = 0.01
      responseRateDown = 0.01
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    CONTROLLER
    {
      name = R1
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 4
      seed = 2
    }
    CONTROLLER
    {
      name = R2
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 4
      seed = 11
    }
    CONTROLLER
    {
      name = R3
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 4
      seed = 23
    }
    CONTROLLER
    {
      name = R4
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 4
      seed = 37
    }
    TEMPLATE
    {
      templateName = nfa-kerozine-afterburner-2
      overrideParentTransform = thrustTransform
      position = 0,0,1
      rotation = 0, 0, 0
      scale = 1.8, 1.8, 2
    }
  }
    
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = BroadswordClosed
    

    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = ClosedCycle
      responseRateUp = 0.03
      responseRateDown = 0.2
    }
	  CONTROLLER
    {
      name = random1
      linkedTo = random
      noiseType = perlin
      scale = 1
      speed = 2
      seed = 3
    }
	  CONTROLLER
    {
      name = random2
      linkedTo = random
      noiseType = perlin
      scale = 1
      speed = 7
      seed = 30
    }
	  CONTROLLER
    {
      name = random3
      linkedTo = random
      noiseType = perlin
      scale = 1
      speed = 7
      seed = 300
    }
	  CONTROLLER
    {
      name = random4
      linkedTo = random
      noiseType = perlin
      scale = 1
      speed = 7
      seed = 3000
    }
   
    TEMPLATE
    {
      templateName = nfa-hydrolox-aerospike
      overrideParentTransform = thrustTransform
      position = 0,0,0.1
      rotation = 0, 0, 0
      scale = 2.25, 2.25, 2.4
    }
  }
}
// AE2 Cutlass
@PART[nfa-multimodal-25-2]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    // This is a custom name
    moduleID = CutlassOpen
    // This links the effects to a given ModuleEngines
    

    // List out all controllers we want available
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = random1
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 10
      seed = 654
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = AirBreathing
      responseRateUp = 10
      responseRateDown = 10
    }
    TEMPLATE
      {
        templateName = nfa-rapier-core
        position = 0,0,-0.3
        rotation = 0, 0, 0
        scale = 1.6, 1.6, 0.9
      }
    TEMPLATE
    {
        templateName = nfa-methane-jet-2
        position = 0,0,-0.4
        rotation = 0, 0, 0
        scale = 2, 2, 4
      }
    }
    
  MODULE
  {
    name = ModuleWaterfallFX
    // This is a custom name
    moduleID = CutlassClosed
    // This links the effects to a given ModuleEngines
    

    // List out all controllers we want available
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = ClosedCycle
      responseRateUp = 0.03
      responseRateDown = 0.2
    }
    CONTROLLER
    {
      name = random1
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 9
      seed = 0
    }
    CONTROLLER
    {
      name = Ignition
      linkedTo = engineEvent
      eventDuration = 2
      eventName = ignition
      eventCurve
      {
        key = 0 0 10 10
        key = 0.1 1 4.444445 4.444445
        key = 1 0 -1.111111 -1.111111
      }
    }
    
    TEMPLATE
    {
      templateName = nfa-rapier-core
        position = 0,0,-0.3
        rotation = 0, 0, 0
        scale = 1.6, 1.6, 0.9
    }
    TEMPLATE
    {
      templateName = nfa-methalox-lower-2
      position = 0,0,-0.1
      rotation = 0, 0, 0
      scale = 0.7, 0.7, 1
    }
  }
}
// AE2B Scimitar
@PART[nfa-multimodal-125-1]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    // This is a custom name
    moduleID = ScimitarOpen
    // This links the effects to a given ModuleEngines
    

    // List out all controllers we want available
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = random1
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 10
      seed = 654
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = AirBreathing
      responseRateUp = 10
      responseRateDown = 10
    }
    TEMPLATE
    {
      templateName = nfa-rapier-core
      position = 0,0,-0.19
      rotation = 0, 0, 0
      scale = 0.65, 0.65, 0.9
    }
    TEMPLATE
    {
      templateName = nfa-methane-jet-2
      position = 0,0,-0.1
      rotation = 0, 0, 0
      scale = 0.8, 0.8, 1.6
    }
  }
    
  MODULE
  {
    name = ModuleWaterfallFX
    // This is a custom name
    moduleID = ScimitarClosed
    // This links the effects to a given ModuleEngines
    

    // List out all controllers we want available
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = ClosedCycle
      responseRateUp = 0.03
      responseRateDown = 0.2
    }
    CONTROLLER
    {
      name = random1
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 9
      seed = 0
    }
    CONTROLLER
    {
      name = Ignition
      linkedTo = engineEvent
      eventDuration = 2
      eventName = ignition
      eventCurve
      {
        key = 0 0 10 10
        key = 0.1 1 4.444445 4.444445
        key = 1 0 -1.111111 -1.111111
      }
    }
    
    TEMPLATE
    {
      templateName = nfa-rapier-core
      position = 0,0,-0.19
      rotation = 0, 0, 0
      scale = 0.65, 0.65, 0.9
    }
    TEMPLATE
    {
      templateName = nfa-methalox-lower-2
      position = 0,0,-0.1
      rotation = 0, 0, 0
      scale = 0.3, 0.3, 0.4
    }
  }
}
// J-593 Arcadia
@PART[nfa-turbofan-25-2]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = ArcadiaFX
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = Cruise
      responseRateUp = 0.001
      responseRateDown = 0.016
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    TEMPLATE
    {
      templateName = nfa-kerozine-afterburner
      overrideParentTransform = ThrustTransform
      position = -0.009,-0.003,-1.06
      rotation = 0, 0, 0
      scale = 1.79, 1.79, 2.5
    }
  }
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = ArcadiaReverseFX
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = ReverseThrust
      responseRateUp = 0.02
      responseRateDown = 0.02
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    TEMPLATE
    {
      templateName = nfa-kerozine-turbofan-1
      overrideParentTransform = ThrustTransformAlt
      position = 0,0,0
      rotation = 0, 0, 0
      scale = 1, 1, 1
    }
  }
}
// J-90 Dudley
@PART[nfa-turbofan-25-1]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = DudleyFX
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = Cruise
      responseRateUp = 0.02
      responseRateDown = 0.02
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    TEMPLATE
    {
      templateName = nfa-kerozine-turbofan-1
      overrideParentTransform = thrustTransform
      position = 0,0,0
      rotation = 0, 0, 0
      scale = 0.8, 0.8, 1
    }
  }
}
// JE-X4 Valkyrie
@PART[nfa-turbojet-25-1]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = ValkyrieFX
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = Cruise
      responseRateUp = 0.01
      responseRateDown = 0.01
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    CONTROLLER
    {
      name = R1
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 4
      seed = 2
    }
    CONTROLLER
    {
      name = R2
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 4
      seed = 11
    }
    CONTROLLER
    {
      name = R3
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 4
      seed = 23
    }
    CONTROLLER
    {
      name = R4
      linkedTo = random
      noiseType = perlin
      scale = 1
      minimum = 0
      speed = 4
      seed = 37
    }
    TEMPLATE
    {
      templateName = nfa-kerozine-afterburner-2
      overrideParentTransform = ThrustTransform
      position = 0,0,0
      rotation = 0, 0, 0
      scale = 1.5, 1.5, 2
    }
  }
}
// J-N160 Fireflash
@PART[nfa-atomic-jet-25-1]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = fireflashFX
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = AirBreathing
      responseRateUp = 0.02
      responseRateDown = 0.02
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    TEMPLATE
    {
      templateName = nfa-kerozine-turbofan-1
      overrideParentTransform = ThrustTransform
      position = 0,0,0
      rotation = 0, 0, 0
      scale = 1, 1, 1
    }
  }
}
// J-N500 Project Eeloo
@PART[nfa-atomic-multimode-25-1]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = eelooOpenFX
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = AirBreathing
      responseRateUp = 0.02
      responseRateDown = 0.02
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    TEMPLATE
    {
      templateName = nfa-kerozine-turbofan-1
      overrideParentTransform = ThrustTransform
      position = 0,0,0
      rotation = 0, 0, 0
      scale = 1, 1, 1
    }
  }
  MODULE {
    name = ModuleWaterfallFX
    moduleID = eelooClosedFX

    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
		  engineID = ClosedCycle
      responseRateUp = 0.1
      responseRateDown = 0.2
    }
	
    CONTROLLER
    {
      name = random1
      linkedTo = random
      noiseType = perlin
      scale = 1.0
      minimum = 0.0
      speed = 10
      seed = 15
    }
	
    TEMPLATE
    {
      templateName = nfa-nuclear-upper-hydrogen
      overrideParentTransform = ThrustTransform
      position = 0,0,-1.4
      rotation = 0, 0, 0
      scale = 1.6, 1.6, 2
    }
  }
}


// JL-40 Hornet VTOL Engine
@PART[nfa-vtol-125-1]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = HornetFX
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = AirBreathing
      responseRateUp = 0.02
      responseRateDown = 0.02
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    TEMPLATE
    {
      templateName = stock-kerozine-turbofan-1
      overrideParentTransform = thrustTransform
      position = 0,0,0
      rotation = 0, 0, 0
      scale = 0.3, 0.3, 0.3
    }
  }
}
// JO-16 Yellowjacket VTOL Engine
@PART[nfa-vtol-0625-1]:NEEDS[Waterfall]:FOR[NearFutureAeronautics]
{
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = YellowjacketFX
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = AirBreathing
      responseRateUp = 0.02
      responseRateDown = 0.02
    }
    CONTROLLER
    {
      name = mach
      linkedTo = mach
    }
    TEMPLATE
    {
      templateName = stock-kerozine-turbofan-1
      overrideParentTransform = thrustTransform
      position = 0,0,0.07
      rotation = 0, 0, 0
      scale = 0.18, 0.18, 0.18
    }
  }
}